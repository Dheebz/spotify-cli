name: 'Test'
description: 'Run cargo test'

inputs:
  features:
    description: 'Features to enable'
    required: false
    default: ''

runs:
  using: 'composite'
  steps:
    - name: Setup Rust
      uses: ./.github/actions/setup-rust

    - name: Run tests
      shell: bash
      run: |
        FEATURE_FLAGS=""
        if [ -n "${{ inputs.features }}" ]; then
          FEATURE_FLAGS="--features ${{ inputs.features }}"
        fi
        cargo test --all-targets $FEATURE_FLAGS
